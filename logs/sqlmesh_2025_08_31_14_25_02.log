2025-08-31 14:25:03,018 - MainThread - databricks.sql.client - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (client.py:241)
2025-08-31 14:25:03,722 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:03,722 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:03,723 - MainThread - databricks.sql.client - INFO - Successfully opened session 01f08697-d004-1665-a1df-9518787c7bb2 (client.py:285)
2025-08-31 14:25:03,955 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:03,955 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:04,235 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:491)
2025-08-31 14:25:04,268 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"alliance"."sqlmesh_example"."full_model"' was not found at /Users/jgcabrera527/Documents/Code/sql-mesh/tests/test_full_model.yaml (console.py:2260)
2025-08-31 14:25:04,271 - MainThread - sqlmesh.core.console - WARNING - The databricks engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-08-31 14:25:04,272 - MainThread - databricks.sql.client - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (client.py:241)
2025-08-31 14:25:04,755 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:04,755 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:04,756 - MainThread - databricks.sql.client - INFO - Successfully opened session 01f08697-d09f-11a6-8846-38d0e7b72cc4 (client.py:285)
2025-08-31 14:25:05,099 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:05,100 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:05,473 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:05,473 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:05,884 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:05,884 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:06,125 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:06,126 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:06,600 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:06,600 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:07,214 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:07,215 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:07,761 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:07,761 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:08,356 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:08,357 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:08,956 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:08,957 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:09,557 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:09,557 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:10,148 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:10,148 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:10,496 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:10,496 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:11,207 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:11,208 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:11,426 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:11,426 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:20,667 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:20,667 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:21,242 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:21,243 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:21,252 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-08-31 14:25:21,652 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:21,652 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:23,475 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:23,475 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:23,479 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-08-31 14:25:23,481 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'alliance.sqlmesh__poc' (evaluator.py:1378)
2025-08-31 14:25:23,481 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ CREATE SCHEMA IF NOT EXISTS `alliance`.`sqlmesh__poc` (base.py:2452)
2025-08-31 14:25:23,759 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:23,760 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:23,761 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-08-31 14:25:23,764 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema alliance.sqlmesh__poc (evaluator.py:444)
2025-08-31 14:25:23,765 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'alliance' AND `table_schema` = 'sqlmesh__poc') AND `table_name` IN ('poc__daily_exports_summary__3053939067', 'poc__weekly_exports_summary__2953295564', 'poc__stg_exports__73843079') (base.py:2452)
2025-08-31 14:25:24,168 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:24,168 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:24,174 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating a physical table for snapshot SnapshotId<"alliance"."poc"."daily_exports_summary": 2396621268> (evaluator.py:856)
2025-08-31 14:25:24,174 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:24,378 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:24,378 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:24,382 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ USE CATALOG `alliance` (base.py:2452)
2025-08-31 14:25:24,661 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:24,661 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:24,670 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'alliance.sqlmesh__poc.poc__daily_exports_summary__3053939067' (evaluator.py:1730)
2025-08-31 14:25:24,671 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:24,879 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:24,880 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:24,886 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ CREATE TABLE IF NOT EXISTS `alliance`.`sqlmesh__poc`.`poc__daily_exports_summary__3053939067` PARTITIONED BY (`export_date`) COMMENT 'Summarizes total export quantity and value by day.' AS SELECT `stg_exports`.`export_date` AS `export_date`, SUM(`stg_exports`.`quantity`) AS `total_quantity`, SUM(`stg_exports`.`total_value`) AS `total_revenue`, COUNT(DISTINCT `stg_exports`.`export_id`) AS `number_of_exports` FROM `alliance`.`sqlmesh__poc`.`poc__stg_exports__73843079` AS `stg_exports` WHERE (`stg_exports`.`export_date` <= CAST('1970-01-01' AS DATE) AND `stg_exports`.`export_date` >= CAST('1970-01-01' AS DATE) AND `stg_exports`.`total_value` > 100) AND FALSE GROUP BY `stg_exports`.`export_date` LIMIT 0 (base.py:2452)
2025-08-31 14:25:26,642 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:26,642 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:26,643 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"alliance"."poc"."daily_exports_summary": 2396621268> (evaluator.py:727)
2025-08-31 14:25:26,643 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:26,823 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:26,823 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:26,825 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ USE CATALOG `alliance` (base.py:2452)
2025-08-31 14:25:27,010 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:27,011 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:27,012 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"alliance"."poc"."daily_exports_summary": 2396621268> (evaluator.py:916)
2025-08-31 14:25:27,022 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-29 00:00:00, 2025-08-31 00:00:00) into alliance.sqlmesh__poc.poc__daily_exports_summary__3053939067' (evaluator.py:947)
2025-08-31 14:25:27,023 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ DESCRIBE `alliance`.`sqlmesh__poc`.`poc__daily_exports_summary__3053939067` (base.py:2452)
2025-08-31 14:25:27,303 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:27,303 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:27,310 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ INSERT INTO `alliance`.`sqlmesh__poc`.`poc__daily_exports_summary__3053939067` REPLACE WHERE `export_date` BETWEEN CAST('2025-08-29' AS DATE) AND CAST('2025-08-30' AS DATE) SELECT `export_date`, `total_quantity`, `total_revenue`, `number_of_exports` FROM (SELECT `stg_exports`.`export_date` AS `export_date`, SUM(`stg_exports`.`quantity`) AS `total_quantity`, SUM(`stg_exports`.`total_value`) AS `total_revenue`, COUNT(DISTINCT `stg_exports`.`export_id`) AS `number_of_exports` FROM `alliance`.`sqlmesh__poc`.`poc__stg_exports__73843079` AS `stg_exports` WHERE `stg_exports`.`export_date` <= CAST('2025-08-30' AS DATE) AND `stg_exports`.`export_date` >= CAST('2025-08-29' AS DATE) AND `stg_exports`.`total_value` > 100 GROUP BY `stg_exports`.`export_date`) AS `_subquery` WHERE `export_date` BETWEEN CAST('2025-08-29' AS DATE) AND CAST('2025-08-30' AS DATE) (base.py:2452)
2025-08-31 14:25:28,373 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:28,374 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:28,419 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-29 00:00:00, 2025-08-31 00:00:00) for snapshot SnapshotId<"alliance"."poc"."daily_exports_summary": 2396621268> (facade.py:619)
2025-08-31 14:25:28,419 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"alliance"."poc"."daily_exports_summary": 2396621268> (interval.py:214)
2025-08-31 14:25:29,947 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:29,948 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:29,954 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating a physical table for snapshot SnapshotId<"alliance"."poc"."weekly_exports_summary": 3657892351> (evaluator.py:856)
2025-08-31 14:25:29,955 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:30,129 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:30,129 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:30,132 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ USE CATALOG `alliance` (base.py:2452)
2025-08-31 14:25:30,333 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:30,333 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:30,351 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'alliance.sqlmesh__poc.poc__weekly_exports_summary__2953295564' (evaluator.py:1730)
2025-08-31 14:25:30,352 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:30,537 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:30,537 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:30,542 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ CREATE TABLE IF NOT EXISTS `alliance`.`sqlmesh__poc`.`poc__weekly_exports_summary__2953295564` PARTITIONED BY (`week_start_date`) COMMENT 'Summarizes total export value to a weekly level.' AS SELECT DATE_TRUNC('WEEK', `daily_exports_summary`.`export_date`) AS `week_start_date`, SUM(`daily_exports_summary`.`total_quantity`) AS `total_weekly_quantity`, SUM(`daily_exports_summary`.`total_revenue`) AS `total_weekly_revenue`, SUM(`daily_exports_summary`.`number_of_exports`) AS `total_weekly_exports` FROM `alliance`.`sqlmesh__poc`.`poc__daily_exports_summary__3053939067` AS `daily_exports_summary` WHERE FALSE AND FALSE GROUP BY DATE_TRUNC('WEEK', `daily_exports_summary`.`export_date`) LIMIT 0 (base.py:2452)
2025-08-31 14:25:32,098 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:32,098 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:32,102 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:32,283 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:32,284 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:32,287 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ ALTER TABLE `alliance`.`sqlmesh__poc`.`poc__weekly_exports_summary__2953295564` ALTER COLUMN `week_start_date` COMMENT 'Truncate the daily date to the start of the week' (base.py:2452)
2025-08-31 14:25:33,194 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:33,195 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:33,196 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"alliance"."poc"."weekly_exports_summary": 3657892351> (evaluator.py:727)
2025-08-31 14:25:33,197 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:33,372 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:33,373 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:33,377 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ USE CATALOG `alliance` (base.py:2452)
2025-08-31 14:25:33,565 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:33,565 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:33,566 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"alliance"."poc"."weekly_exports_summary": 3657892351> (evaluator.py:916)
2025-08-31 14:25:33,573 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-29 00:00:00, 2025-08-31 00:00:00) into alliance.sqlmesh__poc.poc__weekly_exports_summary__2953295564' (evaluator.py:947)
2025-08-31 14:25:33,573 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ DESCRIBE `alliance`.`sqlmesh__poc`.`poc__weekly_exports_summary__2953295564` (base.py:2452)
2025-08-31 14:25:33,817 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:33,817 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:33,828 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ INSERT INTO `alliance`.`sqlmesh__poc`.`poc__weekly_exports_summary__2953295564` REPLACE WHERE `week_start_date` BETWEEN CAST('2025-08-29 00:00:00+00:00' AS TIMESTAMP) AND CAST('2025-08-30 23:59:59.999999+00:00' AS TIMESTAMP) SELECT `week_start_date`, `total_weekly_quantity`, `total_weekly_revenue`, `total_weekly_exports` FROM (SELECT DATE_TRUNC('WEEK', `daily_exports_summary`.`export_date`) AS `week_start_date`, SUM(`daily_exports_summary`.`total_quantity`) AS `total_weekly_quantity`, SUM(`daily_exports_summary`.`total_revenue`) AS `total_weekly_revenue`, SUM(`daily_exports_summary`.`number_of_exports`) AS `total_weekly_exports` FROM `alliance`.`sqlmesh__poc`.`poc__daily_exports_summary__3053939067` AS `daily_exports_summary` WHERE FALSE GROUP BY DATE_TRUNC('WEEK', `daily_exports_summary`.`export_date`)) AS `_subquery` WHERE `week_start_date` BETWEEN CAST('2025-08-29 00:00:00+00:00' AS TIMESTAMP) AND CAST('2025-08-30 23:59:59.999999+00:00' AS TIMESTAMP) (base.py:2452)
2025-08-31 14:25:34,835 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:34,835 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:34,837 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-29 00:00:00, 2025-08-31 00:00:00) for snapshot SnapshotId<"alliance"."poc"."weekly_exports_summary": 3657892351> (facade.py:619)
2025-08-31 14:25:34,837 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"alliance"."poc"."weekly_exports_summary": 3657892351> (interval.py:214)
2025-08-31 14:25:36,398 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:36,398 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:36,402 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-08-31 14:25:36,402 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'dev' (facade.py:167)
2025-08-31 14:25:37,118 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:37,118 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:37,359 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:37,359 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:39,165 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:39,165 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:39,982 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:39,982 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:41,722 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:41,723 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:42,379 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:42,380 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:42,381 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-08-31 14:25:42,385 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'alliance.poc__dev' (evaluator.py:1378)
2025-08-31 14:25:42,385 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ CREATE SCHEMA IF NOT EXISTS `alliance`.`poc__dev` (base.py:2452)
2025-08-31 14:25:42,587 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:42,587 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:42,589 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:42,760 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:42,760 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:42,761 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ USE CATALOG `alliance` (base.py:2452)
2025-08-31 14:25:42,945 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:42,946 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:42,946 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'alliance.poc__dev.exports_source' to point at table 'alliance.sqlmesh__poc.poc__exports_source__4025357751' (evaluator.py:1694)
2025-08-31 14:25:42,947 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'alliance' AND `table_schema` = 'poc__dev') AND `table_name` IN ('exports_source') (base.py:2452)
2025-08-31 14:25:43,362 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:43,362 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:43,366 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ CREATE OR REPLACE VIEW alliance.poc__dev.exports_source AS SELECT * FROM alliance.sqlmesh__poc.poc__exports_source__4025357751 (base.py:2452)
2025-08-31 14:25:44,181 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:44,181 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:44,185 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:44,357 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:44,357 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:44,359 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ USE CATALOG `alliance` (base.py:2452)
2025-08-31 14:25:44,544 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:44,544 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:44,548 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'alliance.poc__dev.stg_exports' to point at table 'alliance.sqlmesh__poc.poc__stg_exports__73843079' (evaluator.py:1694)
2025-08-31 14:25:44,550 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'alliance' AND `table_schema` = 'poc__dev') AND `table_name` IN ('stg_exports') (base.py:2452)
2025-08-31 14:25:44,911 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:44,911 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:44,919 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ CREATE OR REPLACE VIEW alliance.poc__dev.stg_exports AS SELECT * FROM alliance.sqlmesh__poc.poc__stg_exports__73843079 (base.py:2452)
2025-08-31 14:25:45,614 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:45,615 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:45,618 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:45,790 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:45,790 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:45,793 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ USE CATALOG `alliance` (base.py:2452)
2025-08-31 14:25:45,978 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:45,978 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:45,980 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'alliance.poc__dev.daily_exports_summary' to point at table 'alliance.sqlmesh__poc.poc__daily_exports_summary__3053939067' (evaluator.py:1694)
2025-08-31 14:25:45,981 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'alliance' AND `table_schema` = 'poc__dev') AND `table_name` IN ('daily_exports_summary') (base.py:2452)
2025-08-31 14:25:46,312 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:46,312 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:46,314 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ CREATE OR REPLACE VIEW alliance.poc__dev.daily_exports_summary AS SELECT * FROM alliance.sqlmesh__poc.poc__daily_exports_summary__3053939067 (base.py:2452)
2025-08-31 14:25:46,924 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:46,924 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:46,928 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:25:47,103 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:47,104 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:47,106 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ USE CATALOG `alliance` (base.py:2452)
2025-08-31 14:25:47,293 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:47,293 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:47,294 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'alliance.poc__dev.weekly_exports_summary' to point at table 'alliance.sqlmesh__poc.poc__weekly_exports_summary__2953295564' (evaluator.py:1694)
2025-08-31 14:25:47,296 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'alliance' AND `table_schema` = 'poc__dev') AND `table_name` IN ('weekly_exports_summary') (base.py:2452)
2025-08-31 14:25:47,663 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:47,663 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:47,668 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 303859e9bfcf4ca483f1e1c37a510492 */ CREATE OR REPLACE VIEW alliance.poc__dev.weekly_exports_summary AS SELECT * FROM alliance.sqlmesh__poc.poc__weekly_exports_summary__2953295564 (base.py:2452)
2025-08-31 14:25:48,379 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:48,379 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:48,383 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-08-31 14:25:48,383 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'dev' (environment.py:141)
2025-08-31 14:25:48,988 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:48,988 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:50,735 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:50,735 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:50,738 - MainThread - databricks.sql.client - INFO - Closing session 01f08697-d004-1665-a1df-9518787c7bb2 (client.py:399)
2025-08-31 14:25:50,869 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:50,869 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:50,870 - MainThread - databricks.sql.client - INFO - Closing session 01f08697-d09f-11a6-8846-38d0e7b72cc4 (client.py:399)
2025-08-31 14:25:51,000 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:25:51,001 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:25:51,009 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
