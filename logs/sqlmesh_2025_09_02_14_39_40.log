2025-09-02 14:39:40,429 - MainThread - databricks.sql.client - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (client.py:241)
2025-09-02 14:39:40,907 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:40,907 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:40,907 - MainThread - databricks.sql.client - INFO - Successfully opened session 01f0882c-2fb7-1f30-a11b-51a28100a2ed (client.py:285)
2025-09-02 14:39:41,144 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:41,144 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:41,401 - MainThread - sqlmesh.core.console - WARNING - The databricks engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-09-02 14:39:41,403 - MainThread - databricks.sql.client - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (client.py:241)
2025-09-02 14:39:41,794 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:41,795 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:41,796 - MainThread - databricks.sql.client - INFO - Successfully opened session 01f0882c-3042-137f-a685-716596825e87 (client.py:285)
2025-09-02 14:39:42,216 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:42,217 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:42,583 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:42,583 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:42,997 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:42,997 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:43,282 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:43,282 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:43,838 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:43,840 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:44,437 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:44,437 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:44,451 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE `alliance`.`poc`.`daily_exports_summary` (base.py:2452)
2025-09-02 14:39:44,837 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:44,838 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:44,845 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE `alliance`.`poc__dev`.`daily_exports_summary` (base.py:2452)
2025-09-02 14:39:45,139 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:45,139 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:45,157 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-02 14:39:45,361 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:45,361 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:45,368 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2452)
2025-09-02 14:39:45,584 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:45,584 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:45,588 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS `alliance`.`sqlmesh_temp` (base.py:2452)
2025-09-02 14:39:45,797 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:45,798 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:45,807 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS `alliance`.`sqlmesh_temp`.`temp_diff_jqtc8hjz` AS WITH `__source` AS (SELECT `s`.`export_date`, `s`.`total_quantity`, `s`.`total_revenue`, `s`.`number_of_exports`, `s`.`export_date` AS `__sqlmesh_join_key` FROM `alliance`.`poc`.`daily_exports_summary` AS `s`), `__target` AS (SELECT `t`.`export_date`, `t`.`total_quantity`, `t`.`total_revenue`, `t`.`number_of_exports`, `t`.`export_date` AS `__sqlmesh_join_key` FROM `alliance`.`poc__dev`.`daily_exports_summary` AS `t`), `__stats` AS (SELECT `s`.`export_date` AS `s__export_date`, `s`.`total_quantity` AS `s__total_quantity`, `s`.`total_revenue` AS `s__total_revenue`, `s`.`number_of_exports` AS `s__number_of_exports`, `s`.`__sqlmesh_join_key` AS `s____sqlmesh_join_key`, `t`.`export_date` AS `t__export_date`, `t`.`total_quantity` AS `t__total_quantity`, `t`.`total_revenue` AS `t__total_revenue`, `t`.`number_of_exports` AS `t__number_of_exports`, `t`.`__sqlmesh_join_key` AS `t____sqlmesh_join_key`, IF(NOT `s`.`__sqlmesh_join_key` IS NULL, 1, 0) AS `s_exists`, IF(NOT `t`.`__sqlmesh_join_key` IS NULL, 1, 0) AS `t_exists`, IF(`s`.`__sqlmesh_join_key` = `t`.`__sqlmesh_join_key`, 1, 0) AS `row_joined`, IF(`s`.`export_date` IS NULL AND `t`.`export_date` IS NULL, 1, 0) AS `null_grain`, CASE WHEN `s`.`export_date` = `t`.`export_date` THEN 1 WHEN (`s`.`export_date` IS NULL) AND (`t`.`export_date` IS NULL) THEN 1 WHEN (`s`.`export_date` IS NULL) OR (`t`.`export_date` IS NULL) THEN 0 ELSE 0 END AS `export_date_matches`, CASE WHEN `s`.`total_quantity` = `t`.`total_quantity` THEN 1 WHEN (`s`.`total_quantity` IS NULL) AND (`t`.`total_quantity` IS NULL) THEN 1 WHEN (`s`.`total_quantity` IS NULL) OR (`t`.`total_quantity` IS NULL) THEN 0 ELSE 0 END AS `total_quantity_matches`, CASE WHEN ROUND(`s`.`total_revenue`, 3) = ROUND(`t`.`total_revenue`, 3) THEN 1 WHEN (`s`.`total_revenue` IS NULL) AND (`t`.`total_revenue` IS NULL) THEN 1 WHEN (`s`.`total_revenue` IS NULL) OR (`t`.`total_revenue` IS NULL) THEN 0 ELSE 0 END AS `total_revenue_matches`, CASE WHEN `s`.`number_of_exports` = `t`.`number_of_exports` THEN 1 WHEN (`s`.`number_of_exports` IS NULL) AND (`t`.`number_of_exports` IS NULL) THEN 1 WHEN (`s`.`number_of_exports` IS NULL) OR (`t`.`number_of_exports` IS NULL) THEN 0 ELSE 0 END AS `number_of_exports_matches` FROM `__source` AS `s` FULL JOIN `__target` AS `t` ON `s`.`__sqlmesh_join_key` = `t`.`__sqlmesh_join_key`) SELECT *, CASE WHEN `export_date_matches` = 1 AND `total_quantity_matches` = 1 AND `total_revenue_matches` = 1 AND `number_of_exports_matches` = 1 THEN 1 ELSE 0 END AS `row_full_match` FROM `__stats` (base.py:2452)
2025-09-02 14:39:48,420 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:48,420 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:48,425 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT SUM(`s_exists`) AS `s_count`, SUM(`t_exists`) AS `t_count`, SUM(`row_joined`) AS `join_count`, SUM(`null_grain`) AS `null_grain_count`, SUM(`row_full_match`) AS `full_match_count`, SUM(`export_date_matches`) AS `export_date_matches`, SUM(`total_quantity_matches`) AS `total_quantity_matches`, SUM(`total_revenue_matches`) AS `total_revenue_matches`, SUM(`number_of_exports_matches`) AS `number_of_exports_matches`, COUNT(DISTINCT (`s____sqlmesh_join_key`)) AS `distinct_count_s`, COUNT(DISTINCT (`t____sqlmesh_join_key`)) AS `distinct_count_t` FROM `alliance`.`sqlmesh_temp`.`temp_diff_jqtc8hjz` (base.py:2452)
2025-09-02 14:39:49,252 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:49,252 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:49,265 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT ROUND(100 * (CAST(SUM(`export_date_matches`) AS DECIMAL) / COUNT(`export_date_matches`)), 9) AS `export_date_matches`, ROUND(100 * (CAST(SUM(`total_quantity_matches`) AS DECIMAL) / COUNT(`total_quantity_matches`)), 9) AS `total_quantity_matches`, ROUND(100 * (CAST(SUM(`total_revenue_matches`) AS DECIMAL) / COUNT(`total_revenue_matches`)), 9) AS `total_revenue_matches`, ROUND(100 * (CAST(SUM(`number_of_exports_matches`) AS DECIMAL) / COUNT(`number_of_exports_matches`)), 9) AS `number_of_exports_matches` FROM `alliance`.`sqlmesh_temp`.`temp_diff_jqtc8hjz` WHERE `row_joined` = 1 (base.py:2452)
2025-09-02 14:39:49,745 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:49,745 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:49,757 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: WITH `source_only` AS (SELECT 'source_only' AS `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `alliance`.`sqlmesh_temp`.`temp_diff_jqtc8hjz` WHERE `s_exists` = 1 AND `row_joined` = 0 ORDER BY `s__export_date` LIMIT 20), `target_only` AS (SELECT 'target_only' AS `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `alliance`.`sqlmesh_temp`.`temp_diff_jqtc8hjz` WHERE `t_exists` = 1 AND `row_joined` = 0 ORDER BY `t__export_date` LIMIT 20), `common_rows` AS (SELECT 'common_rows' AS `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `alliance`.`sqlmesh_temp`.`temp_diff_jqtc8hjz` WHERE `row_joined` = 1 AND `row_full_match` = 0 ORDER BY `s__export_date`, `t__export_date` LIMIT 20) SELECT `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `source_only` UNION ALL SELECT `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `target_only` UNION ALL SELECT `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `common_rows` (base.py:2452)
2025-09-02 14:39:50,339 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:50,339 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:50,351 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS `alliance`.`sqlmesh_temp`.`temp_diff_jqtc8hjz` (base.py:2452)
2025-09-02 14:39:50,831 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:50,831 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:50,841 - MainThread - databricks.sql.client - INFO - Closing session 01f0882c-3042-137f-a685-716596825e87 (client.py:399)
2025-09-02 14:39:50,965 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-09-02 14:39:50,965 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-09-02 14:39:50,971 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
