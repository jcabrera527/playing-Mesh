2025-08-31 14:29:08,719 - MainThread - databricks.sql.client - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (client.py:241)
2025-08-31 14:29:09,154 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:09,154 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:09,154 - MainThread - databricks.sql.client - INFO - Successfully opened session 01f08698-624d-1579-8b9e-0e8acd3f68a4 (client.py:285)
2025-08-31 14:29:09,405 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:09,405 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:09,729 - MainThread - sqlmesh.core.console - WARNING - The databricks engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2260)
2025-08-31 14:29:09,731 - MainThread - databricks.sql.client - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (client.py:241)
2025-08-31 14:29:10,211 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:10,211 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:10,211 - MainThread - databricks.sql.client - INFO - Successfully opened session 01f08698-62ed-16c9-839f-dbbf7be5e002 (client.py:285)
2025-08-31 14:29:10,540 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:10,540 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:10,738 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:10,738 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:11,010 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:11,010 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:11,280 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:11,280 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:11,933 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:11,933 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:12,330 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:12,330 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:12,342 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE `alliance`.`poc`.`daily_exports_summary` (base.py:2452)
2025-08-31 14:29:12,627 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:12,627 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:12,631 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE `alliance`.`poc__dev`.`daily_exports_summary` (base.py:2452)
2025-08-31 14:29:12,880 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:12,880 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:12,895 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:29:13,070 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:13,070 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:13,073 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2452)
2025-08-31 14:29:13,217 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:13,218 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:13,221 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS `alliance`.`sqlmesh_temp` (base.py:2452)
2025-08-31 14:29:13,530 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:13,530 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:13,533 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS `alliance`.`sqlmesh_temp`.`temp_diff_1t9mcn5l` AS WITH `__source` AS (SELECT `s`.`export_date`, `s`.`total_quantity`, `s`.`total_revenue`, `s`.`number_of_exports`, `s`.`export_date` AS `__sqlmesh_join_key` FROM `alliance`.`poc`.`daily_exports_summary` AS `s`), `__target` AS (SELECT `t`.`export_date`, `t`.`total_quantity`, `t`.`total_revenue`, `t`.`number_of_exports`, `t`.`export_date` AS `__sqlmesh_join_key` FROM `alliance`.`poc__dev`.`daily_exports_summary` AS `t`), `__stats` AS (SELECT `s`.`export_date` AS `s__export_date`, `s`.`total_quantity` AS `s__total_quantity`, `s`.`total_revenue` AS `s__total_revenue`, `s`.`number_of_exports` AS `s__number_of_exports`, `s`.`__sqlmesh_join_key` AS `s____sqlmesh_join_key`, `t`.`export_date` AS `t__export_date`, `t`.`total_quantity` AS `t__total_quantity`, `t`.`total_revenue` AS `t__total_revenue`, `t`.`number_of_exports` AS `t__number_of_exports`, `t`.`__sqlmesh_join_key` AS `t____sqlmesh_join_key`, IF(NOT `s`.`__sqlmesh_join_key` IS NULL, 1, 0) AS `s_exists`, IF(NOT `t`.`__sqlmesh_join_key` IS NULL, 1, 0) AS `t_exists`, IF(`s`.`__sqlmesh_join_key` = `t`.`__sqlmesh_join_key`, 1, 0) AS `row_joined`, IF(`s`.`export_date` IS NULL AND `t`.`export_date` IS NULL, 1, 0) AS `null_grain`, CASE WHEN `s`.`export_date` = `t`.`export_date` THEN 1 WHEN (`s`.`export_date` IS NULL) AND (`t`.`export_date` IS NULL) THEN 1 WHEN (`s`.`export_date` IS NULL) OR (`t`.`export_date` IS NULL) THEN 0 ELSE 0 END AS `export_date_matches`, CASE WHEN `s`.`total_quantity` = `t`.`total_quantity` THEN 1 WHEN (`s`.`total_quantity` IS NULL) AND (`t`.`total_quantity` IS NULL) THEN 1 WHEN (`s`.`total_quantity` IS NULL) OR (`t`.`total_quantity` IS NULL) THEN 0 ELSE 0 END AS `total_quantity_matches`, CASE WHEN ROUND(`s`.`total_revenue`, 3) = ROUND(`t`.`total_revenue`, 3) THEN 1 WHEN (`s`.`total_revenue` IS NULL) AND (`t`.`total_revenue` IS NULL) THEN 1 WHEN (`s`.`total_revenue` IS NULL) OR (`t`.`total_revenue` IS NULL) THEN 0 ELSE 0 END AS `total_revenue_matches`, CASE WHEN `s`.`number_of_exports` = `t`.`number_of_exports` THEN 1 WHEN (`s`.`number_of_exports` IS NULL) AND (`t`.`number_of_exports` IS NULL) THEN 1 WHEN (`s`.`number_of_exports` IS NULL) OR (`t`.`number_of_exports` IS NULL) THEN 0 ELSE 0 END AS `number_of_exports_matches` FROM `__source` AS `s` FULL JOIN `__target` AS `t` ON `s`.`__sqlmesh_join_key` = `t`.`__sqlmesh_join_key`) SELECT *, CASE WHEN `export_date_matches` = 1 AND `total_quantity_matches` = 1 AND `total_revenue_matches` = 1 AND `number_of_exports_matches` = 1 THEN 1 ELSE 0 END AS `row_full_match` FROM `__stats` (base.py:2452)
2025-08-31 14:29:15,735 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:15,735 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:15,740 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT SUM(`s_exists`) AS `s_count`, SUM(`t_exists`) AS `t_count`, SUM(`row_joined`) AS `join_count`, SUM(`null_grain`) AS `null_grain_count`, SUM(`row_full_match`) AS `full_match_count`, SUM(`export_date_matches`) AS `export_date_matches`, SUM(`total_quantity_matches`) AS `total_quantity_matches`, SUM(`total_revenue_matches`) AS `total_revenue_matches`, SUM(`number_of_exports_matches`) AS `number_of_exports_matches`, COUNT(DISTINCT (`s____sqlmesh_join_key`)) AS `distinct_count_s`, COUNT(DISTINCT (`t____sqlmesh_join_key`)) AS `distinct_count_t` FROM `alliance`.`sqlmesh_temp`.`temp_diff_1t9mcn5l` (base.py:2452)
2025-08-31 14:29:16,369 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:16,370 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:16,380 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT ROUND(100 * (CAST(SUM(`export_date_matches`) AS DECIMAL) / COUNT(`export_date_matches`)), 9) AS `export_date_matches`, ROUND(100 * (CAST(SUM(`total_quantity_matches`) AS DECIMAL) / COUNT(`total_quantity_matches`)), 9) AS `total_quantity_matches`, ROUND(100 * (CAST(SUM(`total_revenue_matches`) AS DECIMAL) / COUNT(`total_revenue_matches`)), 9) AS `total_revenue_matches`, ROUND(100 * (CAST(SUM(`number_of_exports_matches`) AS DECIMAL) / COUNT(`number_of_exports_matches`)), 9) AS `number_of_exports_matches` FROM `alliance`.`sqlmesh_temp`.`temp_diff_1t9mcn5l` WHERE `row_joined` = 1 (base.py:2452)
2025-08-31 14:29:16,878 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:16,879 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:16,888 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: WITH `source_only` AS (SELECT 'source_only' AS `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `alliance`.`sqlmesh_temp`.`temp_diff_1t9mcn5l` WHERE `s_exists` = 1 AND `row_joined` = 0 ORDER BY `s__export_date` LIMIT 20), `target_only` AS (SELECT 'target_only' AS `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `alliance`.`sqlmesh_temp`.`temp_diff_1t9mcn5l` WHERE `t_exists` = 1 AND `row_joined` = 0 ORDER BY `t__export_date` LIMIT 20), `common_rows` AS (SELECT 'common_rows' AS `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `alliance`.`sqlmesh_temp`.`temp_diff_1t9mcn5l` WHERE `row_joined` = 1 AND `row_full_match` = 0 ORDER BY `s__export_date`, `t__export_date` LIMIT 20) SELECT `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `source_only` UNION ALL SELECT `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `target_only` UNION ALL SELECT `__sqlmesh_sample_type`, `s__export_date`, `s__total_quantity`, `s__total_revenue`, `s__number_of_exports`, `s____sqlmesh_join_key`, `t__export_date`, `t__total_quantity`, `t__total_revenue`, `t__number_of_exports`, `t____sqlmesh_join_key` FROM `common_rows` (base.py:2452)
2025-08-31 14:29:17,485 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:17,485 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:17,497 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS `alliance`.`sqlmesh_temp`.`temp_diff_1t9mcn5l` (base.py:2452)
2025-08-31 14:29:17,996 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:17,997 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:18,005 - MainThread - databricks.sql.client - INFO - Closing session 01f08698-62ed-16c9-839f-dbbf7be5e002 (client.py:399)
2025-08-31 14:29:18,138 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-08-31 14:29:18,138 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:201)
2025-08-31 14:29:18,145 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
